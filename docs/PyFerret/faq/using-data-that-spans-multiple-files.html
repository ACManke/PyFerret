 
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML+RDFa 1.1//EN">
<html lang="en" dir="ltr" version="HTML+RDFa 1.1"
xmlns:content="http://purl.org/rss/1.0/modules/content/"
xmlns:dc="http://purl.org/dc/terms/"
xmlns:foaf="http://xmlns.com/foaf/0.1/"
xmlns:og="http://ogp.me/ns#"
xmlns:rdfs="http://www.w3.org/2000/01/rdf-schema#"
xmlns:sioc="http://rdfs.org/sioc/ns#"
xmlns:sioct="http://rdfs.org/sioc/types#"
xmlns:skos="http://www.w3.org/2004/02/skos/core#"
xmlns:xsd="http://www.w3.org/2001/XMLSchema#"
xmlns:schema="http://schema.org/">
<head profile="http://www.w3.org/1999/xhtml/vocab">
<title>Using data that spans multiple files. - Ferret/PyFerret FAQs</title>

<link rel="stylesheet" href="../modules/system/system.base.css">
<link rel="stylesheet" href="../modules/system/system.menus.css">
<link rel="stylesheet" href="../modules/system/system.messages.css">
<link rel="stylesheet" href="../modules/system/system.theme.css">

<link rel="stylesheet" href="../sites/all/modules/jquery_update/replace/ui/themes/base/minified/jquery.ui.core.min.css">
<link rel="stylesheet" href="../sites/all/modules/jquery_update/replace/ui/themes/base/minified/jquery.ui.theme.min.css">
<link rel="stylesheet" href="../sites/all/modules/jquery_update/replace/ui/themes/base/minified/jquery.ui.menu.min.css">
<link rel="stylesheet" href="../sites/all/modules/jquery_update/replace/ui/themes/base/minified/jquery.ui.autocomplete.min.css">

<link rel="stylesheet" href="../sites/all/modules/calendar/css/calendar_multiday.css">
<link rel="stylesheet" href="../modules/field/theme/field.css">
<link rel="stylesheet" href="../sites/all/modules/scald/modules/fields/mee/css/editor-global.css">
<link rel="stylesheet" href="../modules/node/node.css">
<link rel="stylesheet" href="../sites/all/modules/scald_file/scald_file.css">
<link rel="stylesheet" href="../modules/search/search.css">
<link rel="stylesheet" href="../modules/user/user.css">
<link rel="stylesheet" href="../sites/all/modules/views/css/views.css">
<link rel="stylesheet" href="../sites/all/modules/ckeditor/css/ckeditor.css">

<link rel="stylesheet" href="../sites/all/modules/ctools/css/ctools.css">
<link rel="stylesheet" href="../sites/all/modules/custom_search/custom_search.css">
<link rel="stylesheet" href="../sites/all/modules/search_autocomplete/css/themes/minimal.css">
<link rel="stylesheet" href="../sites/all/libraries/superfish/css/superfish.css">
<link rel="stylesheet" href="../sites/all/libraries/superfish/css/superfish-smallscreen.css">
<link rel="stylesheet" href="../sites/all/libraries/superfish/css/superfish-vertical.css">

<link rel="stylesheet" href="../sites/all/themes/pacific_marine/css/ckeditor_custom.css">

<link rel="stylesheet" href="../sites/all/themes/omega/alpha/css/alpha-reset.css">
<link rel="stylesheet" href="../sites/all/themes/omega/alpha/css/alpha-mobile.css">
<link rel="stylesheet" href="../sites/all/themes/omega/alpha/css/alpha-alpha.css">
<link rel="stylesheet" href="../sites/all/themes/omega/omega/css/formalize.css">
<link rel="stylesheet" href="../sites/all/themes/omega/omega/css/omega-text.css">
<link rel="stylesheet" href="../sites/all/themes/omega/omega/css/omega-branding.css">
<link rel="stylesheet" href="../sites/all/themes/omega/omega/css/omega-menu.css">
<link rel="stylesheet" href="../sites/all/themes/omega/omega/css/omega-forms.css">
<link rel="stylesheet" href="../sites/all/themes/omega/omega/css/omega-visuals.css">
<link rel="stylesheet" href="../sites/all/themes/pacific_marine/css/global.css">



<link rel="stylesheet" href="../sites/all/themes/pacific_marine/css/pacific-marine-alpha-default.css">
<link rel="stylesheet" href="../sites/all/themes/pacific_marine/css/pacific-marine-alpha-default-wide.css">
<link rel="stylesheet" href="../sites/all/themes/omega/alpha/css/grid/alpha_default/wide/alpha-default-wide-12.css">


</head>
<body class="html not-front not-logged-in page-node page-node- page-node-555 node-type-documentation-page context-documentation">
  <div id="body-bg-top"></div>
  <div id="skip-link">
    <a href="#main-content" class="element-invisible element-focusable">Skip to main content</a>
  </div>
    <div class="page clearfix" id="page">
      <header id="section-header" class="section section-header">
  <div id="zone-header-wrapper" class="zone-wrapper zone-header-wrapper clearfix">  
  <div id="zone-header" class="zone zone-header clearfix container-12">
    <div class="grid-7 region region-branding" id="region-branding">
  <div class="region-inner region-branding-inner">
        <div class="branding-data clearfix">
            <div class="logo-img">
        <a href="../index.html" rel="home" title=""><img src="../sites/all/themes/pacific_marine/images/ferret-banner.png" alt="" id="logo" /></a>
		</div>
                </div>
          </div>
</div><div class="grid-5 region region-header-first" id="region-header-first">
  <div class="region-inner region-header-first-inner">
    <div class="block block-block block-4 block-block-4 odd block-without-title" id="block-block-4">
  <div class="block-inner clearfix">

  </div>
</div>
  </div>
</div>  </div>
</div>  </div>
</div><div id="zone-menu-wrapper" class="zone-wrapper zone-menu-wrapper clearfix">  
  <div id="zone-menu" class="zone zone-menu clearfix container-12">
    <div class="grid-12 region region-menu" id="region-menu">
  <div class="region-inner region-menu-inner">
        <div class="block block-system block-menu block-main-menu block-system-main-menu odd block-without-title" id="block-system-main-menu">
  <div class="block-inner clearfix">
                
    <div class="content clearfix">
      <ul class="menu">
	  <li class="first expanded"><a href="../index.html">Home</a>
	  <ul class="menu">
	  </li>
<li class="leaf"><a href="../index.html">Ferret/PyFerret Home</a></li>
</ul></li>
<li class="leaf"><a href="../documentation/ferret-documentation.html">Documentation</a></li>
<li class="leaf"><a href="ferret-faqs.html">FAQ</a></li>
<li class="collapsed"><a href="../documentation/pyferret/downloads.html">Downloads</a></li>
<li class="collapsed"><a href="../documentation/pyferret-support.html">Support</a></li>
</ul>    </div>
  </div>
</div>  </div>
</div>
  </div>
</div></header> 


      <section id="section-content" class="section section-content">
  <div id="zone-preface-wrapper" class="zone-wrapper zone-preface-wrapper clearfix">  
  <div id="zone-preface" class="zone zone-preface clearfix equal-height-container container-12">
    <div class="grid-3 region region-preface-first equal-height-element" id="region-preface-first">
  <div class="region-inner region-preface-first-inner">
      </div>
</div><div class="grid-9 region region-preface-second equal-height-element" id="region-preface-second">
  <div class="region-inner region-preface-second-inner">
      </div>
</div>  </div>
</div><div id="zone-content-wrapper" class="zone-wrapper zone-content-wrapper clearfix no-sidebar">  
  <div id="zone-content" class="zone zone-content clearfix equal-height-container container-12">    
        
        <div class="grid-12 region region-content equal-height-element" id="region-content">
  <div class="region-inner region-content-inner">
    <a id="main-content"></a>
            <div class="element-invisible">   
    </div>                    <div class="block block-system block-main block-system-main odd block-without-title" id="block-system-main">
  <div class="block-inner clearfix">
                
    <div class="content clearfix">
      <article about="/Ferret/index.html" typeof="foaf:Document" class="node node-page node-published node-not-promoted node-not-sticky author-burger odd clearfix" id="node-page-771">

<h2 class="block-title"><a href="ferret-faqs.html" class="active-trail">FAQ</a></h2>
<a id="main-content"></a>
<div class="element-invisible">    <h1 class="title" id="page-title">Using data that spans multiple files.</h1>
</div>                    <div class="block block-system block-main block-system-main odd block-without-title" id="block-system-main">
<div class="block-inner clearfix">
 
<div class="content clearfix">
<article about="/Ferret/faq/using-data-that-spans-multiple-files" typeof="foaf:Document" class="node node-page node-published node-not-promoted node-not-sticky author-ansley odd clearfix" id="node-page-709">

<h1 id="page title"  class="node-title">Using data that spans multiple files.</h1>  <div class="content clearfix">
 
<div class="field field-name-body field-type-text-with-summary field-label-hidden">
<div class="field-items">
<div class="field-item even" property="content:encoded"><h2>Question:</h2>
<blockquote><p>How can I plot the time series of a variable which spans multiple data files?</p></blockquote>
<h2>Example:</h2>
<blockquote><p>&gt; I have some netcdf-files with a lot of data. Each file represents the<br />
&gt; status of a certain model time. Now I want to plot one variable (say the<br />
&gt; instantanous mean) as a function of time. How can I do it?<br />
&gt;<br />
&gt; And can I save the calculated time series in a seperate (binary or netcdf)<br />
&gt; file from Ferret?</p></blockquote>
<h2>Explanation:</h2>
<p>The answer to this depends on how your existing NetCDF files are arranged. You say that each file has a single time step. Let us suppose there are 3 spatial dimensions for the variables in your NetCDF files. There are two ways that this could be encoded: either as 3D (time-independent) variables or as 4D variables on a single point time axis. "ncdump -h mynetcdf.cdf" will show if the variables have a 1-point time axis.</p>
<h2>Solution:</h2>
<p><b>==&gt; If the files have a 1 point time axis there are three solutions:</b></p>
<ol><li>If you have a THREDDS server installed, use THREDDS aggregation to make the data into a single virtual dataset. THREDDS aggregation may be used to combine files that contain different timesteps of the same variable(s). <b> </b>It also includes other powerful tools for modifying and combining datasets.<br />
	 </li>
<li>Define a virtual dataset in the Ferret session (Ferret v7 and higher) using <a href="../documentation/users-guide/commands-reference/DEFINE#_define_data_agg" title="DEFINE">DEFINE DATA/AGGREGATE/T</a>.  (Virtual dataset aggregation may also be done in the E direction, to define an ensemble, or the F direction, defining a forecast collection.)<br /><pre>
<b>yes? let file_list = SPAWN("ls -1 tmp/step_*.nc")
yes? TSERIES all_times = file_list
</b></pre></li>
<li>Use ferret to concatenate the files:<br /><pre>
use file1
save/file=concat.cdf var1, var2, var3
use file2
save/append/file=concat.cdf var1,var2,var3
.
.
.</pre><p>	note that the names "var1", "var2",... refer to the "current" data set since no explicit data set was specified as in "var1[d=file1]".</p></li>
<p>	 </p>
<li> </li>
<li> </li>
<li> </li>
<li> </li>
<li>Create an "MC" (multi-cdf) data set by writing a <a href="../documentation/users-guide/converting-to-netcdf/CREATING-A-MULTI-FILE-NETCDF-DATA-SET.html" title="10.4 CREATING A MULTI-FILE NETCDF DATA SET">descriptor file</a> that ties the files into a single data set. An example of such a descriptor is below.</li>
</ol><p><b>==&gt; If your files do not have a time word, </b></p>
<p> </p>
<ul><li>then you must use Ferret to impose atime word. Suppose you have 10 files, each separated by one model day, running 1-jan-1980 to 10-jan-1980. Then you might use this technique:<br /><pre>
! *** set up
define axis/t=1-jan-1980:10-jan-1980:1/unit=days t10days
define grid/t=t10days gg
 
let var1_with_T = t[g=gg]*0 + var1
set variable/title="xxx"/units="uuu" var1_with_T
 
! *** loop over input files
use file1.cdf
save/file=concat.cdf var1_with_T[l=1]
 
use file2.cdf
save/file=concat.cdf/append var1_with_T[l=2]
 
...
</pre></li>
</ul><p> </p>
<p>
--------------------------------------------------<br />
Here is an example "MC" descriptorfile: my_mc_descriptor.des:</p>
<p> </p>
<pre>
$FORMAT_RECORD
D_TYPE = ' MC',
D_FORMAT = ' 1A',
D_SOURCE_CLASS = 'MODEL OUTPUT',
D_SOURCE = 'PHIL/SIEG',
D_SUBSOURCE = 'TROPICAL PACIFIC',
$END
$BACKGROUND_RECORD
D_EXPNUM = '0068',
D_MODNUM = ' AA',
D_TITLE = 'MOM model output; Hindcast, Double Ramp; NCEP 79-95 twice daily winds'
D_FORCING_SET = 'NCEP 79-95 daily',
D_T0TIME = '14-JAN-1978 14:00:00',
D_TIME_UNIT = 3600.0,
D_TIME_MODULO = .TRUE.,
D_ADD_PARM = 15*' ',
$END
$MESSAGE_RECORD
D_MESSAGE = ' ',
D_ALERT_ON_OPEN = F,
D_ALERT_ON_OUTPUT = F,
$END
*************************************************
*************************************************
$EXTRA_RECORD
$END
 
$STEPFILE_RECORD
s_filename = 'mtaa068-nc.001',
S_AUX_SET_NUM = 0,
S_START = 87623.0,
S_END = 183599.0,
S_DELTA = 24.0,
S_NUM_OF_FILES = 400,
S_REGVARFLAG = ' ',
$END
**************************************************
$STEPFILE_RECORD
s_filename = '**END OF STEPFILES**'
$END
**************************************************
</pre><p> </p>
<hr /><p> </p>
</div>
</div>
</div>

</div>

<div class="clearfix">
<nav class="links node-links clearfix"></nav>

</div>
</article>    </div>
</div>
</div>      </div>
</div>  </div>
</div></section>    
 
<footer id="section-footer" class="section section-footer">

  <div id="zone-footer-wrapper" class="zone-wrapper zone-footer-wrapper clearfix">  
  <div id="zone-footer" class="zone zone-footer clearfix container-12">
    <div class="grid-8 region region-footer-first" id="region-footer-first">
  <div class="region-inner region-footer-first-inner">
    <div class="block block-block block-1 block-block-1 odd block-without-title" id="block-block-1">
  <div class="block-inner clearfix">
                
  </div>
</div><div class="block block-block block-2 block-block-2 even block-without-title" id="block-block-2">
  <div class="block-inner clearfix">
                
  </div>
</div><div class="block block-menu block-menu-footer-first-menu block-menu-menu-footer-first-menu odd block-without-title" id="block-menu-menu-footer-first-menu">

  </div>
</div>  </div>
</div><div class="grid-4 region region-footer-second" id="region-footer-second">
  <div class="region-inner region-footer-second-inner">
    <div class="block block-menu block-menu-footer-second-menu block-menu-menu-footer-second-menu odd block-without-title" id="block-menu-menu-footer-second-menu">
  <div class="block-inner clearfix">
                
  </div>
</div>  </div>
</div>  </div>
</div></footer>  </div>  <div class="region region-page-bottom" id="region-page-bottom">
  <div class="region-inner region-page-bottom-inner">
      </div>
</div>  <div id="body-bg-bottom"></div>
</body>
</html>
