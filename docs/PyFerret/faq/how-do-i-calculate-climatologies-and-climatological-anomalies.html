 
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML+RDFa 1.1//EN">
<html lang="en" dir="ltr" version="HTML+RDFa 1.1"
xmlns:content="http://purl.org/rss/1.0/modules/content/"
xmlns:dc="http://purl.org/dc/terms/"
xmlns:foaf="http://xmlns.com/foaf/0.1/"
xmlns:og="http://ogp.me/ns#"
xmlns:rdfs="http://www.w3.org/2000/01/rdf-schema#"
xmlns:sioc="http://rdfs.org/sioc/ns#"
xmlns:sioct="http://rdfs.org/sioc/types#"
xmlns:skos="http://www.w3.org/2004/02/skos/core#"
xmlns:xsd="http://www.w3.org/2001/XMLSchema#"
xmlns:schema="http://schema.org/">
<head profile="http://www.w3.org/1999/xhtml/vocab">
<title>How do I calculate climatologies and climatological anomalies? - Ferret/PyFerret FAQs</title>

<link rel="stylesheet" href="../modules/system/system.base.css">
<link rel="stylesheet" href="../modules/system/system.menus.css">
<link rel="stylesheet" href="../modules/system/system.messages.css">
<link rel="stylesheet" href="../modules/system/system.theme.css">

<link rel="stylesheet" href="../sites/all/modules/jquery_update/replace/ui/themes/base/minified/jquery.ui.core.min.css">
<link rel="stylesheet" href="../sites/all/modules/jquery_update/replace/ui/themes/base/minified/jquery.ui.theme.min.css">
<link rel="stylesheet" href="../sites/all/modules/jquery_update/replace/ui/themes/base/minified/jquery.ui.menu.min.css">
<link rel="stylesheet" href="../sites/all/modules/jquery_update/replace/ui/themes/base/minified/jquery.ui.autocomplete.min.css">

<link rel="stylesheet" href="../sites/all/modules/calendar/css/calendar_multiday.css">
<link rel="stylesheet" href="../modules/field/theme/field.css">
<link rel="stylesheet" href="../sites/all/modules/scald/modules/fields/mee/css/editor-global.css">
<link rel="stylesheet" href="../modules/node/node.css">
<link rel="stylesheet" href="../sites/all/modules/scald_file/scald_file.css">
<link rel="stylesheet" href="../modules/search/search.css">
<link rel="stylesheet" href="../modules/user/user.css">
<link rel="stylesheet" href="../sites/all/modules/views/css/views.css">
<link rel="stylesheet" href="../sites/all/modules/ckeditor/css/ckeditor.css">

<link rel="stylesheet" href="../sites/all/modules/ctools/css/ctools.css">
<link rel="stylesheet" href="../sites/all/modules/custom_search/custom_search.css">
<link rel="stylesheet" href="../sites/all/modules/search_autocomplete/css/themes/minimal.css">
<link rel="stylesheet" href="../sites/all/libraries/superfish/css/superfish.css">
<link rel="stylesheet" href="../sites/all/libraries/superfish/css/superfish-smallscreen.css">
<link rel="stylesheet" href="../sites/all/libraries/superfish/css/superfish-vertical.css">

<link rel="stylesheet" href="../sites/all/themes/pacific_marine/css/ckeditor_custom.css">

<link rel="stylesheet" href="../sites/all/themes/omega/alpha/css/alpha-reset.css">
<link rel="stylesheet" href="../sites/all/themes/omega/alpha/css/alpha-mobile.css">
<link rel="stylesheet" href="../sites/all/themes/omega/alpha/css/alpha-alpha.css">
<link rel="stylesheet" href="../sites/all/themes/omega/omega/css/formalize.css">
<link rel="stylesheet" href="../sites/all/themes/omega/omega/css/omega-text.css">
<link rel="stylesheet" href="../sites/all/themes/omega/omega/css/omega-branding.css">
<link rel="stylesheet" href="../sites/all/themes/omega/omega/css/omega-menu.css">
<link rel="stylesheet" href="../sites/all/themes/omega/omega/css/omega-forms.css">
<link rel="stylesheet" href="../sites/all/themes/omega/omega/css/omega-visuals.css">
<link rel="stylesheet" href="../sites/all/themes/pacific_marine/css/global.css">



<link rel="stylesheet" href="../sites/all/themes/pacific_marine/css/pacific-marine-alpha-default.css">
<link rel="stylesheet" href="../sites/all/themes/pacific_marine/css/pacific-marine-alpha-default-wide.css">
<link rel="stylesheet" href="../sites/all/themes/omega/alpha/css/grid/alpha_default/wide/alpha-default-wide-12.css">


</head>
<body class="html not-front not-logged-in page-node page-node- page-node-555 node-type-documentation-page context-documentation">
  <div id="body-bg-top"></div>
  <div id="skip-link">
    <a href="#main-content" class="element-invisible element-focusable">Skip to main content</a>
  </div>
    <div class="page clearfix" id="page">
      <header id="section-header" class="section section-header">
  <div id="zone-header-wrapper" class="zone-wrapper zone-header-wrapper clearfix">  
  <div id="zone-header" class="zone zone-header clearfix container-12">
    <div class="grid-7 region region-branding" id="region-branding">
  <div class="region-inner region-branding-inner">
        <div class="branding-data clearfix">
            <div class="logo-img">
        <a href="../index.html" rel="home" title=""><img src="../sites/all/themes/pacific_marine/images/ferret-banner.png" alt="" id="logo" /></a>
		</div>
                </div>
          </div>
</div><div class="grid-5 region region-header-first" id="region-header-first">
  <div class="region-inner region-header-first-inner">
    <div class="block block-block block-4 block-block-4 odd block-without-title" id="block-block-4">
  <div class="block-inner clearfix">

  </div>
</div>
  </div>
</div>  </div>
</div>  </div>
</div><div id="zone-menu-wrapper" class="zone-wrapper zone-menu-wrapper clearfix">  
  <div id="zone-menu" class="zone zone-menu clearfix container-12">
    <div class="grid-12 region region-menu" id="region-menu">
  <div class="region-inner region-menu-inner">
        <div class="block block-system block-menu block-main-menu block-system-main-menu odd block-without-title" id="block-system-main-menu">
  <div class="block-inner clearfix">
                
    <div class="content clearfix">
      <ul class="menu">
	  <li class="first expanded"><a href="../index.html">Home</a>
	  <ul class="menu">
	  </li>
<li class="leaf"><a href="../index.html">Ferret/PyFerret Home</a></li>
</ul></li>
<li class="leaf"><a href="../documentation/ferret-documentation.html">Documentation</a></li>
<li class="leaf"><a href="ferret-faqs.html">FAQ</a></li>
<li class="collapsed"><a href="../documentation/pyferret/downloads.html">Downloads</a></li>
<li class="collapsed"><a href="../documentation/pyferret-support.html">Support</a></li>
</ul>    </div>
  </div>
</div>  </div>
</div>
  </div>
</div></header> 


      <section id="section-content" class="section section-content">
  <div id="zone-preface-wrapper" class="zone-wrapper zone-preface-wrapper clearfix">  
  <div id="zone-preface" class="zone zone-preface clearfix equal-height-container container-12">
    <div class="grid-3 region region-preface-first equal-height-element" id="region-preface-first">
  <div class="region-inner region-preface-first-inner">
      </div>
</div><div class="grid-9 region region-preface-second equal-height-element" id="region-preface-second">
  <div class="region-inner region-preface-second-inner">
      </div>
</div>  </div>
</div><div id="zone-content-wrapper" class="zone-wrapper zone-content-wrapper clearfix no-sidebar">  
  <div id="zone-content" class="zone zone-content clearfix equal-height-container container-12">    
        
        <div class="grid-12 region region-content equal-height-element" id="region-content">
  <div class="region-inner region-content-inner">
    <a id="main-content"></a>
            <div class="element-invisible">   
    </div>                    <div class="block block-system block-main block-system-main odd block-without-title" id="block-system-main">
  <div class="block-inner clearfix">
                
    <div class="content clearfix">
      <article about="/Ferret/index.html" typeof="foaf:Document" class="node node-page node-published node-not-promoted node-not-sticky author-burger odd clearfix" id="node-page-771">

<h2 class="block-title"><a href="ferret-faqs.html" class="active-trail">FAQ</a></h2>
<a id="main-content"></a>
<div class="element-invisible">    <h1 class="title" id="page-title">How do I calculate climatologies and climatological anomalies?</h1>
</div>                    <div class="block block-system block-main block-system-main odd block-without-title" id="block-system-main">
<div class="block-inner clearfix">
 
<div class="content clearfix">
<article about="/Ferret/faq/how-do-i-calculate-climatologies-and-climatological-anomalies" typeof="foaf:Document" class="node node-page node-published node-not-promoted node-not-sticky author-ansley odd clearfix" id="node-page-666">

<h1 id="page title"  class="node-title">How do I calculate climatologies and climatological anomalies?</h1>  <div class="content clearfix">
 
<div class="field field-name-body field-type-text-with-summary field-label-hidden">
<div class="field-items">
<div class="field-item even" property="content:encoded"><h2>Question:</h2>
<blockquote><p>Subject: computing monthly anomalies</p>
<p>Â </p>
<p>What I want to do is this:</p>
<p>Given 6 years of data - 72 months</p>
<p>(1) compute the seasonal cycle ( 12 months - each an average of the 6 Jan, Febs ... etc.)</p>
<p>(2) compute the anomalies from the climatology - 72 months of data - (eg jan 79 minus jan climo ....)</p>
<p>
I can do (1) easily using the modulo regridding, so far any way of doing (2) has eluded me.</p>
</blockquote>
<h2>Quick example and explanation:</h2>
<p><b>Compute the climatological anomaly for a time series of zonal winds.<br />
(using the Ferret demo dataset <i>monthly_navy_winds</i>)</b></p>
<pre>
! Example data set: model-generated global winds
! (This data set included with standard Ferret distribution)
 
yes? SET DATA monthly_navy_winds
 
! Get the climatological axis that you want to use
! Here we will use the pre-defined axis ("MONTH_REG")
! (If the SHOW AXIS returns nothing, see the note at the bottom of this page**)
 
yes? SHOW AXIS month_reg
name       axis              # pts   start                end
MONTH_REG TIME                12mr   16-JAN 06:00         16-DEC 01:20
T0 = 01-JAN-0000 00:00:00
Axis span (to cell edges) = 8765.82 (modulo length = axis span)
 
 
! (optional) Set the time range of data to be used in the climatology
 
yes? LET uwnd_of_interest = uwnd[T=15-jan-1983:15-jan-1991]
yes? PLOT/X=180/Y=40 uwnd_of_interest
 
</pre><div class="image">
<div class="dnd-atom-wrapper type-image context-sdl_editor_representation" contenteditable="false">
<div class="dnd-drop-wrapper"><!-- scald=92:sdl_editor_representation --><div class='image'><img typeof="foaf:Image" src="../sites/default/files/thumbnails/image/climatology_1.png" width="1017" height="407" alt="Original UWND data versus time" title="climatology_1.png" /></div><!-- END scald=92 --></div>
<div class="dnd-legend-wrapper" contenteditable="true">
<div class="meta">
<!--copyright=92--><!--END copyright=92--></div>
</div>
</div>
<p>Â </p>
</div>
<pre>
! Compute the climatology and plot over
 
yes? LET uwnd_climatology = uwnd_of_interest[GT=month_reg@MOD]
yes? PLOT/X=180/Y=40/OVERLAY uwnd_climatology[T=15-jan-1983:15-jan-1991]
</pre><div class="image">Â </div>
<div class="image">Â </div>
<div class="dnd-atom-wrapper type-image context-sdl_editor_representation" contenteditable="false">
<div class="dnd-drop-wrapper"><!-- scald=93:sdl_editor_representation --><div class='image'><img typeof="foaf:Image" src="../sites/default/files/thumbnails/image/climatology_2.png" width="1017" height="407" alt="Original data and the computed climatology on the same time axis" title="climatology_2.png" /></div><!-- END scald=93 --></div>
<div class="dnd-legend-wrapper" contenteditable="true">
<div class="meta">
<!--copyright=93--><!--END copyright=93--></div>
</div>
</div>
<pre>
! Subtract to get the anomaly
! Regrid the anomaly back to the original time axis using @asn to guarantee
! success (Subtle interpolation errors may occur on irregular time axes 
! if the @asn regridding isn't done.)
 
yes? LET uwnd_anomaly = uwnd - uwnd_climatology[gt=uwnd@asn]
yes? PLOT/color=blue/X=180/Y=40/T=15-jan-1983:15-jan-1991 uwnd_anomaly
 
 
</pre><div class="dnd-atom-wrapper type-image context-sdl_editor_representation" contenteditable="false">
<div class="dnd-drop-wrapper"><!-- scald=94:sdl_editor_representation --><div class='image'><img typeof="foaf:Image" src="../sites/default/files/thumbnails/image/climatology_3.png" width="1017" height="407" alt="Anomaly = uwnd - climatology versus time" title="climatology_3.png" /></div><!-- END scald=94 --></div>
<div class="dnd-legend-wrapper" contenteditable="true">
<div class="meta">
<!--copyright=94--><!--END copyright=94--></div>
</div>
</div>
<p>but wait, with my dataset, I get an error:</p>
<pre>
yes? use my_current_data
yes? plot/X=180/Y=40 U
 
yes? LET U_climatology = U[GT=month_reg@MOD]
yes? PLOT/X=180/Y=40/OVERLAY U_climatology
**ERROR: regridding: only @ASN, @LIN, or @NRST regridding between calendar types: NOLEAP, GREGORIAN
 
</pre><p>The incoming data is on a different calendar, so the regridding operation we defined is not valid. We'll need to use another climatological axis. These calendars are defined automatically in Ferret: MONTH_IRREG, MONTH_REG, MONTH_GREGORIAN, MONTH_NOLEAP, MONTH_360_DAY, MONTH_ALL_LEAP, MONTH_JULIAN. Choose a monthly climatological axis with the same calendar as the source data:</p>
<pre>
yes? say `U,return=calendar` 
!-&gt; MESSAGE/CONTINUE NOLEAP
NOLEAP
 
! Define the climatology accordingly,
yes? LET U_climatology = U[GT=month_noleap@MOD]
yes? PLOT/X=180/Y=40/OVERLAY U_climatology
 
</pre><p>Â </p>
<p>Â </p>
<p>Â </p>
<h2>Detailed explanation to full question:</h2>
<p>There are actually 4 steps to what you want to do:</p>
<p>
1) Pick a time region over which you would like to compute a climatology</p>
<p>2) Compute a climatology with a compressed time axis (only 12 points)</p>
<p>3) regrid the climatology on the full time axis (72 points in your case)</p>
<p>4) subtract the original variable from the regrided climatology (at each of the 72 points)</p>
<p>Â </p>
<p>I will walk you through this below. In order to do all this we need to tell ferret the name of the compressed time axis (climatology) grid and the name of the full time axis (72 point) grid.</p>
<p>Â </p>
<blockquote><p>&gt; What I want to do is this.</p>
<p>&gt; Given 6 years of data - 72 months</p>
</blockquote>
<p>
Okay, so we have a variable, call it MY_VAR, in a dataset, call it MY_DATASET which has a certain time axis, call it MY_TIME_AXIS (which has 72 points) as part of a grid MY_GRID.</p>
<p>Â </p>
<blockquote><p>&gt; (1) compute the seasonal cycle ( 12 months - each an average of the 6 Jan, Febs ... etc.)</p>
</blockquote>
<p>
Okay to do this we can use some regridding tools in FERRET, but first we need to choose the climatological axis:</p>
<pre>
yes? show axis month*</pre><p>MONTH_IRREG has different sized boxes to reflect the fact that March has 31 days while April has only 30, etc... while MONTH_REG has 12 months of equal size (30 days each).Â  Monthly calendar axes for non-Gregorian calendars are also included.</p>
<p>Now that we have the appropriate time axis, we need to pick out the region of data that over which we would like to calculate the climatology. This is not strictly necessary - by default FERRET will compute the climatology over the entire range of the data set (despite whatever time region is set using SET REGION/T=). However, you may not want the climatology of ALL the data... for example, you might have 1946-1996 data but only want the climatology for the years 1946-1976.</p>
<p>
So we set up an intermediate variable, MY_VAR_LIMITED_TIME_RANGE</p>
<pre>
yes? let MY_VAR_LIMITED_TIME_RANGE = MY_VAR[t="1-jan-1946":"31-dec-1976"]
</pre><p>Okay, now we can set up the climatology</p>
<pre>
yes? let MY_CLIMATOLOGY = MY_VAR_LIMITED_TIME_RANGE[gt=MONTH_IRREG@mod]
</pre><p>This uses the regridding tool gt=@mod which will average the months and put the result onto the compressed climatology time axis MONTH_IRREG that we set up earlier.</p>
<blockquote><p>&gt; (2) compute the anomalies from the climatology - 72 months of data - (eg jan 79 - jan climo ....)</p>
</blockquote>
<p>
Now in order to do this we need the climatology, MY_CLIMATOLOGY, to be on the full time axis of the orginal variable MY_VAR. So once again, we need to regrid, this time from the time axis MONTH_IRREG to the time axis of the full variable.We can use the name of the time variable MY_VAR to specify the full time axis.</p>
<p>So, type</p>
<pre>
yes? let @asn]
 
! or, if you like:
 
yes? let MY_ANOMALY = MY_VAR_LIMITED_TIME_RANGE - MY_CLIMATOLOGY[gt=MY_VAR_LIMITED_TIME_RANGE@asn]</pre><p>and you are done. MY_ANOMALY will be on the exact same grid as MY_VAR.</p>
<p>Â </p>
<p>Note that we use the @asn regridding transformation to regrid the climatology time axis back onto the full time axis. The reason for doing this is subtle: The climatological axis and the actual year length may not quite match - for example in a Gregorian calendar the climatology contains 365.2425 days in its year, the actual year may be a leap year with 366 days or a non-leap year with 365 days. We use @asn to tell Ferret not to worry about this mismatch but to instead use the January value at each January etc... If you don't use the @asn transformation, Ferret will try to account for the different length months, etc... by interpolating which can lead to slightly different values being used for each January, etc...</p>
<p>Â </p>
<p>Here is another detail regarding climatological regridding:</p>
<p>In addition, the commonplace (somewhat sloppy) way that most climatologies are computed is that all data falling within a particular calendar month boundary go into the computed average of that month of the climatological average. If we regard the climatological year as a representation of the earth's tilt relative to the sun (the solar year), then this way of computing climatological averages means that there are small alterations (up to
<p>To do it more carefully, average in 2 stages:</p>
<ol><li>
<p style="text-align: left;">average the original (say, daily) data onto a true-month Gregorian calendar axis using @ave. This calculation will respect the calendar month boundaries, including leap years. The target climatology axis could be used, specifying the input date range, and using @ave rather than @mod. (To define true-monthly axes, see the sections on <a href="../documentation/users-guide/commands-reference/DEFINE.html#PartII-DefineTrueMonthly.html">DEFINE AXIS/EDGES</a> and the script def_monthaxis_days.jnl also discussed inthat section.</p>
</li>
<li>
<p>Now do the modulo regridding from this monthly average which takes into account the month lengths in each year.</p>
</li>
</ol><p>Â </p>
<p>Â </p>
<pre>
**NOTE
! Prior to Ferret v6.9, needed to USE and CANCEL this dataset. The next two
! commands not needed in v6.9 and higher. 
! The pre-defined climatological axes include all of the 
! calendar definions (Gregorian, NOLEAP, LEAP, etc.)
 
! Or to use additional climatological axes, such as those in the definition datasets
! clim_axes_gregorian.nc. clim_axes_julian.nc, or clim_axes_noleap.nc , use this
! this same sequence: use and cancel the definition dataset. 
 
yes? USE climatological_axes
yes? CANCEL DATA climatological_axes
</pre><hr /><p><i>Contributed by Sim Larkin<br />
Last Modified: Feb 10 1997</i></p>
</div>
</div>
</div>

</div>

<div class="clearfix">
<nav class="links node-links clearfix"></nav>

</div>
</article>    </div>
</div>
</div>      </div>
</div>  </div>
</div></section>    
 
<footer id="section-footer" class="section section-footer">

  <div id="zone-footer-wrapper" class="zone-wrapper zone-footer-wrapper clearfix">  
  <div id="zone-footer" class="zone zone-footer clearfix container-12">
    <div class="grid-8 region region-footer-first" id="region-footer-first">
  <div class="region-inner region-footer-first-inner">
    <div class="block block-block block-1 block-block-1 odd block-without-title" id="block-block-1">
  <div class="block-inner clearfix">
                
  </div>
</div><div class="block block-block block-2 block-block-2 even block-without-title" id="block-block-2">
  <div class="block-inner clearfix">
                
  </div>
</div><div class="block block-menu block-menu-footer-first-menu block-menu-menu-footer-first-menu odd block-without-title" id="block-menu-menu-footer-first-menu">

  </div>
</div>  </div>
</div><div class="grid-4 region region-footer-second" id="region-footer-second">
  <div class="region-inner region-footer-second-inner">
    <div class="block block-menu block-menu-footer-second-menu block-menu-menu-footer-second-menu odd block-without-title" id="block-menu-menu-footer-second-menu">
  <div class="block-inner clearfix">
                
  </div>
</div>  </div>
</div>  </div>
</div></footer>  </div>  <div class="region region-page-bottom" id="region-page-bottom">
  <div class="region-inner region-page-bottom-inner">
      </div>
</div>  <div id="body-bg-bottom"></div>
</body>
</html>
