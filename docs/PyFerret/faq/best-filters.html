 
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML+RDFa 1.1//EN">
<html lang="en" dir="ltr" version="HTML+RDFa 1.1"
xmlns:content="http://purl.org/rss/1.0/modules/content/"
xmlns:dc="http://purl.org/dc/terms/"
xmlns:foaf="http://xmlns.com/foaf/0.1/"
xmlns:og="http://ogp.me/ns#"
xmlns:rdfs="http://www.w3.org/2000/01/rdf-schema#"
xmlns:sioc="http://rdfs.org/sioc/ns#"
xmlns:sioct="http://rdfs.org/sioc/types#"
xmlns:skos="http://www.w3.org/2004/02/skos/core#"
xmlns:xsd="http://www.w3.org/2001/XMLSchema#"
xmlns:schema="http://schema.org/">
<head profile="http://www.w3.org/1999/xhtml/vocab">
<title>Best Filters - Ferret/PyFerret FAQs</title>

<link rel="stylesheet" href="../modules/system/system.base.css">
<link rel="stylesheet" href="../modules/system/system.menus.css">
<link rel="stylesheet" href="../modules/system/system.messages.css">
<link rel="stylesheet" href="../modules/system/system.theme.css">

<link rel="stylesheet" href="../sites/all/modules/jquery_update/replace/ui/themes/base/minified/jquery.ui.core.min.css">
<link rel="stylesheet" href="../sites/all/modules/jquery_update/replace/ui/themes/base/minified/jquery.ui.theme.min.css">
<link rel="stylesheet" href="../sites/all/modules/jquery_update/replace/ui/themes/base/minified/jquery.ui.menu.min.css">
<link rel="stylesheet" href="../sites/all/modules/jquery_update/replace/ui/themes/base/minified/jquery.ui.autocomplete.min.css">

<link rel="stylesheet" href="../sites/all/modules/calendar/css/calendar_multiday.css">
<link rel="stylesheet" href="../modules/field/theme/field.css">
<link rel="stylesheet" href="../sites/all/modules/scald/modules/fields/mee/css/editor-global.css">
<link rel="stylesheet" href="../modules/node/node.css">
<link rel="stylesheet" href="../sites/all/modules/scald_file/scald_file.css">
<link rel="stylesheet" href="../modules/search/search.css">
<link rel="stylesheet" href="../modules/user/user.css">
<link rel="stylesheet" href="../sites/all/modules/views/css/views.css">
<link rel="stylesheet" href="../sites/all/modules/ckeditor/css/ckeditor.css">

<link rel="stylesheet" href="../sites/all/modules/ctools/css/ctools.css">
<link rel="stylesheet" href="../sites/all/modules/custom_search/custom_search.css">
<link rel="stylesheet" href="../sites/all/modules/search_autocomplete/css/themes/minimal.css">
<link rel="stylesheet" href="../sites/all/libraries/superfish/css/superfish.css">
<link rel="stylesheet" href="../sites/all/libraries/superfish/css/superfish-smallscreen.css">
<link rel="stylesheet" href="../sites/all/libraries/superfish/css/superfish-vertical.css">

<link rel="stylesheet" href="../sites/all/themes/pacific_marine/css/ckeditor_custom.css">

<link rel="stylesheet" href="../sites/all/themes/omega/alpha/css/alpha-reset.css">
<link rel="stylesheet" href="../sites/all/themes/omega/alpha/css/alpha-mobile.css">
<link rel="stylesheet" href="../sites/all/themes/omega/alpha/css/alpha-alpha.css">
<link rel="stylesheet" href="../sites/all/themes/omega/omega/css/formalize.css">
<link rel="stylesheet" href="../sites/all/themes/omega/omega/css/omega-text.css">
<link rel="stylesheet" href="../sites/all/themes/omega/omega/css/omega-branding.css">
<link rel="stylesheet" href="../sites/all/themes/omega/omega/css/omega-menu.css">
<link rel="stylesheet" href="../sites/all/themes/omega/omega/css/omega-forms.css">
<link rel="stylesheet" href="../sites/all/themes/omega/omega/css/omega-visuals.css">
<link rel="stylesheet" href="../sites/all/themes/pacific_marine/css/global.css">



<link rel="stylesheet" href="../sites/all/themes/pacific_marine/css/pacific-marine-alpha-default.css">
<link rel="stylesheet" href="../sites/all/themes/pacific_marine/css/pacific-marine-alpha-default-wide.css">
<link rel="stylesheet" href="../sites/all/themes/omega/alpha/css/grid/alpha_default/wide/alpha-default-wide-12.css">


</head>
<body class="html not-front not-logged-in page-node page-node- page-node-555 node-type-documentation-page context-documentation">
  <div id="body-bg-top"></div>
  <div id="skip-link">
    <a href="#main-content" class="element-invisible element-focusable">Skip to main content</a>
  </div>
    <div class="page clearfix" id="page">
      <header id="section-header" class="section section-header">
  <div id="zone-header-wrapper" class="zone-wrapper zone-header-wrapper clearfix">  
  <div id="zone-header" class="zone zone-header clearfix container-12">
    <div class="grid-7 region region-branding" id="region-branding">
  <div class="region-inner region-branding-inner">
        <div class="branding-data clearfix">
            <div class="logo-img">
        <a href="../index.html" rel="home" title=""><img src="../sites/all/themes/pacific_marine/images/ferret-banner.png" alt="" id="logo" /></a>
		</div>
                </div>
          </div>
</div><div class="grid-5 region region-header-first" id="region-header-first">
  <div class="region-inner region-header-first-inner">
    <div class="block block-block block-4 block-block-4 odd block-without-title" id="block-block-4">
  <div class="block-inner clearfix">

  </div>
</div>
  </div>
</div>  </div>
</div>  </div>
</div><div id="zone-menu-wrapper" class="zone-wrapper zone-menu-wrapper clearfix">  
  <div id="zone-menu" class="zone zone-menu clearfix container-12">
    <div class="grid-12 region region-menu" id="region-menu">
  <div class="region-inner region-menu-inner">
        <div class="block block-system block-menu block-main-menu block-system-main-menu odd block-without-title" id="block-system-main-menu">
  <div class="block-inner clearfix">
                
    <div class="content clearfix">
      <ul class="menu">
	  <li class="first expanded"><a href="../index.html">Home</a>
	  <ul class="menu">
	  </li>
<li class="leaf"><a href="../index.html">Ferret/PyFerret Home</a></li>
</ul></li>
<li class="leaf"><a href="../documentation/ferret-documentation.html">Documentation</a></li>
<li class="leaf"><a href="ferret-faqs.html">FAQ</a></li>
<li class="collapsed"><a href="../documentation/pyferret/downloads.html">Downloads</a></li>
<li class="collapsed"><a href="../documentation/pyferret-support.html">Support</a></li>
</ul>    </div>
  </div>
</div>  </div>
</div>
  </div>
</div></header> 


      <section id="section-content" class="section section-content">
  <div id="zone-preface-wrapper" class="zone-wrapper zone-preface-wrapper clearfix">  
  <div id="zone-preface" class="zone zone-preface clearfix equal-height-container container-12">
    <div class="grid-3 region region-preface-first equal-height-element" id="region-preface-first">
  <div class="region-inner region-preface-first-inner">
      </div>
</div><div class="grid-9 region region-preface-second equal-height-element" id="region-preface-second">
  <div class="region-inner region-preface-second-inner">
      </div>
</div>  </div>
</div><div id="zone-content-wrapper" class="zone-wrapper zone-content-wrapper clearfix no-sidebar">  
  <div id="zone-content" class="zone zone-content clearfix equal-height-container container-12">    
        
        <div class="grid-12 region region-content equal-height-element" id="region-content">
  <div class="region-inner region-content-inner">
    <a id="main-content"></a>
            <div class="element-invisible">   
    </div>                    <div class="block block-system block-main block-system-main odd block-without-title" id="block-system-main">
  <div class="block-inner clearfix">
                
    <div class="content clearfix">
      <article about="/Ferret/index.html" typeof="foaf:Document" class="node node-page node-published node-not-promoted node-not-sticky author-burger odd clearfix" id="node-page-771">

<h2 class="block-title"><a href="ferret-faqs.html" class="active-trail">FAQ</a></h2>
<a id="main-content"></a>
<div class="element-invisible">    <h1 class="title" id="page-title">Best Filters</h1>
</div>                    <div class="block block-system block-main block-system-main odd block-without-title" id="block-system-main">
<div class="block-inner clearfix">
 
<div class="content clearfix">
<article about="/Ferret/faq/best-filters" typeof="foaf:Document" class="node node-page node-published node-not-promoted node-not-sticky author-ansley odd clearfix" id="node-page-631">

<h1 id="page title"  class="node-title">Best Filters</h1>  <div class="content clearfix">
 
<div class="field field-name-body field-type-text-with-summary field-label-hidden">
<div class="field-items">
<div class="field-item even" property="content:encoded"><h2>Question:</h2>
<pre>
Which are the best filters to use for high and low-pass filtering?
</pre><h2>Example:</h2>
<p><img class="image-inline" src="../sites/default/files/images/faq/best_filters_example.gif" /></p>
<p> </p>
<h2>Explanation:</h2>
<p>The best feature of the triangle filter (@spz) is that its frequency response functions are easy to work with. The reason really is that a triangle is just a boxcar (@sbx) applied twice, and the boxcar ha ssimple properties.</p>
<p> </p>
<p>Try it: take some time series you have lying around, say it is the Ferret variable "ts". Then try:</p>
<pre>
let tssbx3=ts[l=@sbx:3]
plot tssbx3[l=@sbx:3],ts[l=@spz:5] ! lines are the same
</pre><p>or</p>
<pre>
let tssbx11=ts[l=@sbx:11]
plot tssbx11[l=@sbx:11],ts[l=@spz:21] ! lines are the same
</pre><p><b>The boxcar filter of length n applied twice is exactly the same as the triangle filter of length (2n-1).</b></p>
<p>The frequency response of the boxcar filter is the sinc function:</p>
<pre>
sinc(x) = sin(pi*x)/(pi*x)
</pre><p>where x is frequency, and the value of the function sinc(x) gives the fraction of amplitude at frequency x(=1/T) that is passed by the filter.</p>
<p>The frequency response of the boxcar applied twice is sinc^2(n).</p>
<p>It is easy to plot these functions:</p>
<pre>
yes? let xx=x[gx=0:10:.01]
yes? let pi=4.*atan(1.)
yes? let pix=pi*xx
yes? let sinc=sin(pix)/pix
yes? plot sinc,sinc^2
</pre><p> </p>
<p>
<img class="image-inline" src="../sites/default/files/images/faq/best_filters_1.gif" /></p>
<p> </p>
<p> </p>
<p>Note that both are 1 at x=0, decrease to 0 at x=1, and are wavy with decreasing amplitude at higher values of x. The value x=1 refers to a frequency of 1/(length of the boxcar). The value x=0 is the mean value of the time series. Note that sinc(x) takes both positive and negative values (the "ringing" referred to above is the negative lobes), but sinc^2(x) does not.</p>
<p> </p>
<p>Note that the functions sinc and sinc^2 plotted above correspond to a boxcar of length n and a triangle of length 2n-1. For example, to@sbx:3 and @spz:5. The plot does <b>NOT</b> compare the frequency response of @sbx:n and @spz:n! It compares @sbx:n and @spz:(2n-1). To compare equal filter lengths:</p>
<pre>
yes? let x2=xx/2
yes? let pix2=pi*x2
yes? let sinc2=sin(pix2)/pix2
yes? plot sinc,sinc2^2
</pre><p><img class="image-inline" src="../sites/default/files/images/faq/best_filters_2.gif" /></p>
<p> </p>
<p>That is, a triangle of length n is a weaker filter than a boxcar ofthe same length.</p>
<p> </p>
<p>A common way to measure the power of a filter is by the "half-power point", which is the point where the frequency response function equals0.5. These values are x=0.60335 for sinc(x) and x=0.44295 for sinc^2(x).This means that for @sbx:3, the half-power point is at frequency0.60335/3, corresponding to period 4.97 time units. For @spz:3, the half power point is at frequency 0.44295/1.5=3.39 time units.</p>
<p>Continuing the above plot (now stretch it out to see details):</p>
<pre>
yes? plot/x=0:2 sinc,sinc2^2
yes? ppl aline,1,0,.5,2,.5
yes? ppl aline,1,.60335,-.3,.60335,1
yes? ppl aline,1,`2*.44295`,-.3,`2*.44295`,1
</pre><p><img class="image-inline" src="../sites/default/files/images/faq/best_filters_3.gif" /></p>
<p> </p>
<p>When evaluating a high-pass filter formed by subtraction</p>
<p> </p>
<p>highpass = original - lowpass</p>
<p>the frequency response functions are just 1 - (freq resp of lowpass).</p>
<p>Other filters (like binomial, Hanning, etc) are really quite similar in their results, but the boxcar/triangle is much easier to analyze. A further reason to use it is that there are fairly straightforward objective ways to estimate the result of a boxcar filter in the presence of data gaps (see the appendix to Chelton and Davis, 1982,JPO, 12, 757-784). It is easy to extend this to the triangle. I am not aware that this can be done with the other filters (in any case it would surely be more complicated).</p>
<p>The books I like that talk about this stuff are:</p>
<ul><li>Bracewell, R.N., 1978. The Fourier transform and its applications. McGraw-Hill, New York</li>
<li>Bloomfield, P., 1976. Fourier decomposition of time series: An introduction. John Wiley, New York.</li>
</ul><p> </p>
<p>
<i>Contributed by Billy Kessler, Pacific Marine Environmental Laboratory<br />
Last modified: Aug 25, 1998</i></p>
</div>
</div>
</div>

</div>

<div class="clearfix">
<nav class="links node-links clearfix"></nav>

</div>
</article>    </div>
</div>
</div>      </div>
</div>  </div>
</div></section>    
 
<footer id="section-footer" class="section section-footer">

  <div id="zone-footer-wrapper" class="zone-wrapper zone-footer-wrapper clearfix">  
  <div id="zone-footer" class="zone zone-footer clearfix container-12">
    <div class="grid-8 region region-footer-first" id="region-footer-first">
  <div class="region-inner region-footer-first-inner">
    <div class="block block-block block-1 block-block-1 odd block-without-title" id="block-block-1">
  <div class="block-inner clearfix">
                
  </div>
</div><div class="block block-block block-2 block-block-2 even block-without-title" id="block-block-2">
  <div class="block-inner clearfix">
                
  </div>
</div><div class="block block-menu block-menu-footer-first-menu block-menu-menu-footer-first-menu odd block-without-title" id="block-menu-menu-footer-first-menu">

  </div>
</div>  </div>
</div><div class="grid-4 region region-footer-second" id="region-footer-second">
  <div class="region-inner region-footer-second-inner">
    <div class="block block-menu block-menu-footer-second-menu block-menu-menu-footer-second-menu odd block-without-title" id="block-menu-menu-footer-second-menu">
  <div class="block-inner clearfix">
                
  </div>
</div>  </div>
</div>  </div>
</div></footer>  </div>  <div class="region region-page-bottom" id="region-page-bottom">
  <div class="region-inner region-page-bottom-inner">
      </div>
</div>  <div id="body-bg-bottom"></div>
</body>
</html>
